spring.application.name=ch-users-service
spring.main.lazy-initialization=true

server.port=8080

## Database Configuration
spring.r2dbc.name=CH-UsersDB
spring.r2dbc.username=chuser
spring.r2dbc.password=ch-password
spring.r2dbc.url=r2dbc:postgresql://localhost:5432/CH-UsersDB

## R2DBC Connection Pool Configuration
spring.r2dbc.pool.enabled=true
spring.r2dbc.pool.initial-size=2
spring.r2dbc.pool.max-size=10
spring.r2dbc.pool.max-idle-time=10m
spring.r2dbc.pool.max-life-time=30m
spring.r2dbc.pool.max-acquire-time=30s
spring.r2dbc.pool.max-create-connection-time=30s
spring.r2dbc.pool.validation-query=SELECT 1
spring.r2dbc.pool.validation-depth=REMOTE

## Flyway Configuration (uses JDBC for migrations)
spring.flyway.url=jdbc:postgresql://localhost:5432/CH-UsersDB
spring.flyway.user=chuser
spring.flyway.password=ch-password
spring.flyway.locations=classpath:db/migration
spring.flyway.enabled=true

## Actuator Configuration (health probes for Kubernetes, metrics handled by OTEL agent)
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=always
management.endpoint.health.probes.enabled=true
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true

## Logging Configuration
## Log levels and patterns are managed in logback-spring.xml for Grafana/Loki JSON output

## OpenAPI / SpringDoc Configuration
springdoc.api-docs.enabled=true
springdoc.api-docs.path=/v3/api-docs
springdoc.show-actuator=false
springdoc.default-produces-media-type=application/json
springdoc.default-consumes-media-type=application/json

## Kafka Configuration
spring.kafka.bootstrap-servers=${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}
spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value-serializer=org.springframework.kafka.support.serializer.JsonSerializer
spring.kafka.producer.properties.spring.json.type.mapping=userEvent:org.binary.scripting.chusersservice.event.UserEvent

## Kafka Topics
app.kafka.topics.user-events=user-events
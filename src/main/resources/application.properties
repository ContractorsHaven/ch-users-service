spring.application.name=ch-users-service

server.port=8080

## Database Configuration
spring.r2dbc.name=CH-UsersDB
spring.r2dbc.username=chuser
spring.r2dbc.password=ch-password
spring.r2dbc.url=r2dbc:postgresql://localhost:5432/CH-UsersDB

## R2DBC Connection Pool Configuration
spring.r2dbc.pool.enabled=true
spring.r2dbc.pool.initial-size=5
spring.r2dbc.pool.max-size=50
spring.r2dbc.pool.max-idle-time=10m
spring.r2dbc.pool.max-life-time=30m
spring.r2dbc.pool.max-acquire-time=30s
spring.r2dbc.pool.max-create-connection-time=30s
spring.r2dbc.pool.validation-query=SELECT 1
spring.r2dbc.pool.validation-depth=REMOTE

## Flyway Configuration (uses JDBC for migrations)
spring.flyway.url=jdbc:postgresql://localhost:5432/CH-UsersDB
spring.flyway.user=chuser
spring.flyway.password=ch-password
spring.flyway.locations=classpath:db/migration
spring.flyway.enabled=true

## Actuator Configuration
management.endpoints.web.exposure.include=health,info,prometheus,metrics
management.endpoint.health.show-details=always
management.endpoint.health.probes.enabled=true
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true
management.prometheus.metrics.export.enabled=true

## Metrics Configuration
management.metrics.enable.jvm=true
management.metrics.enable.process=true
management.metrics.enable.system=true
management.metrics.enable.http=true
management.metrics.enable.disk=true
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.tags.application=${spring.application.name}

## Logging Configuration
logging.level.root=INFO
logging.level.org.binary.scripting.chusersservice=DEBUG
logging.level.io.r2dbc.pool=DEBUG
logging.level.io.r2dbc.postgresql=INFO
logging.level.org.springframework.r2dbc=DEBUG
logging.level.org.springframework.data.r2dbc=DEBUG
logging.level.org.flywaydb=INFO

## Log connection pool metrics
logging.level.io.r2dbc.pool.ConnectionPool=DEBUG
logging.level.io.r2dbc.pool.PoolMetrics=DEBUG

## Log pattern with timestamp and thread info
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
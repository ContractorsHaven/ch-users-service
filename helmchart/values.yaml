replicaCount: 1

nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: false
  name: ""

autoscaling:
  enabled: false

# Pod annotations for OpenTelemetry auto-instrumentation (metrics handled by OTEL agent)
podAnnotations:
  instrumentation.opentelemetry.io/inject-java: "true"

# OpenTelemetry configuration - disable unused instrumentations for faster startup
otel:
  enabled: true
  serviceName: ch-users-service
  # Disable all by default, then enable only what we need
  instrumentations:
    # Enable instrumentations for this service
    spring-webflux: true
    r2dbc: true
    kafka: true
    netty: true
    reactor: true
    # Disable unused instrumentations
    jdbc: false
    hibernate: false
    servlet: false
    tomcat: false
    jetty: false
    grpc: false
    aws-sdk: false
    mongo: false
    redis: false
    elasticsearch: false
    cassandra: false

# Health probes using actuator
startupProbe:
  httpGet:
    path: /actuator/health
    port: http
  initialDelaySeconds: 45
  periodSeconds: 10
  failureThreshold: 30

livenessProbe:
  httpGet:
    path: /actuator/health/liveness
    port: http
  periodSeconds: 10
  failureThreshold: 5

readinessProbe:
  httpGet:
    path: /actuator/health/readiness
    port: http
  periodSeconds: 5
  failureThreshold: 5

image:
  registry: docker.io
  repository: danyzift/ch-users-service
  tag: 0.0.13
  pullPolicy: Always

service:
  type: ClusterIP
  port: 8080

env:
  JAVA_TOOL_OPTIONS: >
    -Xms128m -Xmx256m
    -XX:+UseSerialGC
    -XX:TieredStopAtLevel=1
    -XX:MaxMetaspaceSize=64m
    -Xss256k
    -XX:CICompilerCount=2
    -Dspring.jmx.enabled=false
    -Djava.security.egd=file:/dev/./urandom
    -Dreactor.netty.ioWorkerCount=2
  KAFKA_BOOTSTRAP_SERVERS: "kafka-kafka.contractors-haven.svc.cluster.local:9092"

requests:
  cpu: "100m"
  memory: "256Mi"
limits:
  cpu: "500m"
  memory: "512Mi"

# PostgreSQL configuration
postgresql:
  enabled: true
  image:
    repository: postgres
    tag: "18.1-alpine"
    pullPolicy: IfNotPresent
  auth:
    database: CH-UsersDB
    username: chuser
    password: ch-password
  persistence:
    enabled: true
    size: 5Gi
  resources:
    requests:
      cpu: "200m"
      memory: "512Mi"
    limits:
      cpu: "500m"
      memory: "1Gi"